Gene Set Enrichment Analysis (GSEA) of similarities in gene expression patterns
To examine overlap in gene sets by expression, we used GSEApy. Briefly, we generated pre-ranked lists from our data on experimental deletion or silencing of TDP-43 in human or mouse brain endothelial cells, or from cells of mice with ALS/FTD associated mutations in Tardbp or Grn. These ranked lists were filtered for BaseMean expression>5, to exclude genes that were not expressed at a sufficient level to be called as differential, and ranked based on Log2 fold-change. We then examined the relative enrichment of MSigDB Hallmark (2020) and KEGG(2021) pathway Gene Sets within the ranked list, using GSEApy parameters “log2 ratio of classes” and “weighted score type 1” with 1000 permutations. In addition, we created custom gene sets from our own data, or from publicly available data. The specific datasets used and their parameters are listed in SI Table 6. From these datasets we extracted the most significantly upregulated or downregulated genes, resulting in the generation of two Gene Sets from each perturbation. These custom gene sets were mapped to the human homologue using BioMart if derived from mouse data, and then used in a GSEA search as previously described. Normalized Enrichment Score (NES) and adjusted p-value resulting from these GSEA searches are shown on the associated heatmap. To determine similar pathways, the overlap in pathways is shown in NetworkX, where the overlap between any two data sets is given as the total number of genes in common between the datasets divided by the total number of genes in both datasets (% overlap).  Key enriched pathways were plotted in GSEApy, to show the placement of pathway genes among the up or downregulated transcripts in the datasets.
